<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="MFIN7036 Students 2025" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="Group FIN-TANSTIC WIZARDS, Progress Report, " />

<meta property="og:title" content="Thoughts and Processing on Regression Variables (by &#34;Group 9&#34;) "/>
<meta property="og:url" content="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/thoughts-and-processing-on-regression-variables-by-group-9.html" />
<meta property="og:description" content="By Group &#34;FIN-TANSTIC WIZARDS&#34; Introduction In this installment of our GitHub-hosted project, we dive into the preparation of regression variables to analyze the influence of a Social Media Sentiment Divergence Index on Bitcoin’s trading volume and volatility. Having already cleaned the Bitcoin historical data and computed the sentiment divergence …" />
<meta property="og:site_name" content="MFIN7036 Student Blog 2025" />
<meta property="og:article:author" content="MFIN7036 Students 2025" />
<meta property="og:article:published_time" content="2025-03-09T00:00:00+08:00" />
<meta name="twitter:title" content="Thoughts and Processing on Regression Variables (by &#34;Group 9&#34;) ">
<meta name="twitter:description" content="By Group &#34;FIN-TANSTIC WIZARDS&#34; Introduction In this installment of our GitHub-hosted project, we dive into the preparation of regression variables to analyze the influence of a Social Media Sentiment Divergence Index on Bitcoin’s trading volume and volatility. Having already cleaned the Bitcoin historical data and computed the sentiment divergence …">

        <title>Thoughts and Processing on Regression Variables (by &#34;Group 9&#34;)  · MFIN7036 Student Blog 2025
</title>
        <link href="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="MFIN7036 Student Blog 2025 - Full Atom Feed" />



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/"><span class=site-name>MFIN7036 Student Blog 2025</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       https://buehlmaier.github.io/MFIN7036-student-blog-2025-01
                                    >Home</a>
                                </li>
                                <li ><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/categories.html">Categories</a></li>
                                <li ><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/tags.html">Tags</a></li>
                                <li ><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/thoughts-and-processing-on-regression-variables-by-group-9.html">
                Thoughts and Processing on Regression Variables (by "Group 9")
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>By <strong>Group "FIN-TANSTIC WIZARDS"</strong></p>
<h2>Introduction</h2>
<p>In this installment of our GitHub-hosted project, we dive into the preparation of regression variables to analyze the influence of a Social Media Sentiment Divergence Index on Bitcoin’s trading volume and volatility. Having already cleaned the Bitcoin historical data and computed the sentiment divergence index in previous steps, our focus now shifts to defining the variables for regression analysis. This blog explains the process of constructing these variables, the rationale behind our choices, and how we prepared the final dataset for regression. Reflecting on this stage, we realize how much we’ve learned about data manipulation and the importance of thoughtful variable design.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Spyder Editor</span>

<span class="sd">This is a temporary script file.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&#39;&#39;&#39;1. Data Cleaning&#39;&#39;&#39;</span>
<span class="sd">&#39;&#39;&#39;pip install pandas numpy openpyxl&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">openpyxl</span> <span class="k">as</span> <span class="nn">opl</span>
</code></pre></div>

<h2>Building the Regression Variables</h2>
<p>After cleaning the Bitcoin historical data (sourced from Investing.com) and merging it with the sentiment divergence index, we proceeded to create and refine the variables needed for regression. Below is a detailed breakdown of the steps we took. This part of the journey was exciting yet challenging—we initially struggled with understanding how to transform raw financial data into meaningful variables. It took some trial and error to get the formulas right, but we persevered by breaking the problem into smaller steps and consulting documentation.</p>
<h3>1. Adding Volatility and Range Metrics</h3>
<ul>
<li><strong>Daily Returns (<code>Return</code>)</strong>: We calculated daily returns as a measure of Bitcoin’s price volatility using the formula:<br>
<img alt="Picture showing Powell" src="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/images/Fintasticwizards_06_formula_returns.png"></li>
</ul>
<p>In the code, this was implemented as <code>df['Price'] / df['Price'].shift(-1) - 1</code>, where <code>shift(-1)</code> aligns the previous day’s price. This variable captures the percentage change in price, a standard proxy for volatility in financial studies. We found it tricky at first to align the time series correctly, but adjusting the shift direction solved the issue.</p>
<ul>
<li><strong>Price Range (<code>Prange</code>)</strong>: We introduced <code>Prange</code> to capture intraday volatility, defined as:<br>
<img alt="Picture showing Powell" src="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/images/Fintasticwizards_06_formula_prange.png"></li>
</ul>
<p>This logarithmic ratio of daily high to low price reflects intraday fluctuations, complementing <code>Return</code> as an alternative volatility measure. The logarithmic transformation was a conceptual leap for us, and we spent time researching why it’s preferred in finance to stabilize variance.</p>
<div class="highlight"><pre><span></span><code><span class="sd">&#39;&#39;&#39;1.2 Cleaning Bitcoin Data from Investing.com&#39;&#39;&#39;</span>
<span class="c1"># Read the CSV file and convert it to a parquet file</span>
<span class="n">csv_file</span> <span class="o">=</span> <span class="s2">&quot;Bitcoin historical data.csv&quot;</span>
<span class="n">csv_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Prevent warning messages</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">csv_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>

<span class="c1"># Modify data types</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">process_vol</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="c1"># Extract numeric value and unit</span>
    <span class="n">num_part</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># Remove B, M, K, or comma</span>
    <span class="k">if</span> <span class="n">num_part</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">num_part</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">NA</span>
        <span class="k">return</span> <span class="n">num_part</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">num</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">num_part</span><span class="p">)</span>  <span class="c1"># Convert to float</span>

    <span class="c1"># Adjust value based on unit</span>
    <span class="k">if</span> <span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">num</span> <span class="o">*</span> <span class="mi">1000000000</span>
    <span class="k">elif</span> <span class="s1">&#39;M&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">num</span> <span class="o">*</span> <span class="mi">1000000</span>
    <span class="k">elif</span> <span class="s1">&#39;K&#39;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">num</span> <span class="o">*</span> <span class="mi">1000</span>  
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">num</span>  <span class="c1"># Return as is if no unit</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span> <span class="s1">&#39;Open&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Vol.&#39;</span><span class="p">]:</span>
    <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">process_vol</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">)</span>

<span class="c1"># Add variable &#39;Return&#39;, calculated as return_t = (Price_t - Price_t-1) / Price_t-1</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Return&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

<span class="c1"># Add variable &#39;Prange&#39;, calculated as prange_t = ln(High_t / Low_t)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Prange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;High&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Low&#39;</span><span class="p">])</span>
</code></pre></div>

<h3>2. Adjusting Trading Volume (<code>aVol</code>)</h3>
<p>We created an adjusted volume variable <code>aVol</code> to normalize daily trading volume against its historical average:<br>
<img alt="Picture showing Powell" src="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/images/Fintasticwizards_06_formula_vol.png"></p>
<p>This calculates the current volume relative to a 120-day average (from ( t-140 ) to ( t-21 )), then subtracts 1 to express deviation as a percentage. We chose this approach to account for long-term trends, ensuring the volume reflects relative changes rather than raw magnitudes, which can vary widely over time. The indexing for the 120-day window was a technical hurdle—we had to debug several times to ensure the slice was correctly aligned.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Add variable &#39;aVol&#39;, calculated as aVol_t = aVol_t / [(aVol_t-21 + ... + aVol_t-140)/120] - 1</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;aVol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Vol.&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Vol.&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">21</span> <span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Vol.&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">140</span><span class="p">][</span><span class="s1">&#39;Vol.&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">120</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</code></pre></div>

<h3>3. Identifying Extreme Returns (<code>Ext_pos</code> and <code>Ext_neg</code>)</h3>
<p>To capture extreme market movements, we defined two binary variables: <code>Ext_pos</code> and <code>Ext_neg</code>, indicating days with extremely positive or negative returns:</p>
<ul>
<li>Computed the rolling mean (<code>Return_mean</code>) and standard deviation (<code>Return_std</code>) of returns over a 120-day window, shifted with <code>shift(-121)</code>.</li>
<li>Defined:<br>
<img alt="Picture showing Powell" src="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/images/Fintasticwizards_06_formula_ext.png">
This two-standard-deviation threshold identifies outliers often tied to significant market events or sentiment-driven reactions. Implementing the rolling window and applying the conditions was a learning curve—we initially misaligned the shift, but adjusting the <code>-121</code> offset fixed it.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Add variables &#39;Ext_pos&#39; and &#39;Ext_neg&#39;</span>
<span class="c1"># &#39;Ext_pos&#39; and &#39;Ext_neg&#39; take the value of 1 for days with extremely positive and negative returns, respectively, and 0 otherwise</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Return_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Return&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">121</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Return_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Return&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">121</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Extreme_pos</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">Return</span> <span class="o">&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">Return_mean</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">Return_std</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">Extreme_neg</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">Return</span> <span class="o">&lt;</span> <span class="n">x</span><span class="o">.</span><span class="n">Return_mean</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">Return_std</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Ext_pos&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Return&#39;</span><span class="p">,</span> <span class="s1">&#39;Return_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;Return_std&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">Extreme_pos</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Ext_neg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Return&#39;</span><span class="p">,</span> <span class="s1">&#39;Return_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;Return_std&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">Extreme_neg</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<h3>4. Merging with Sentiment Data and User Activity</h3>
<ul>
<li>Loaded the precomputed sentiment divergence index from <code>daily_sentiment1or-1(2).parquet</code> and saved it as an Excel file (<code>Disagreement.xlsx</code>) for reference. This dataset includes <code>disagt_t</code>, the daily sentiment divergence index.</li>
<li>Incorporated user activity data from <code>reply_author_count.csv</code>, tracking unique users replying to Bitcoin-related posts. We applied a natural logarithm to the user count (<code>ln_user</code>) to normalize its skewed distribution.</li>
<li>Merged these datasets with the Bitcoin data using the <code>Date</code> column as the key, using an outer join to retain all data points, then dropped rows with missing values for completeness. Merging datasets was a new challenge—we had to ensure date formats matched, which required some debugging with <code>pd.to_datetime</code>.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="sd">&#39;&#39;&#39;1.3 Adding Sentiment Divergence Index&#39;&#39;&#39;</span>
<span class="c1"># Read the Parquet file</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;daily_sentiment1or-1(2).parquet&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;Disagreement.xlsx&#39;</span><span class="p">)</span>

<span class="c1"># Add user count data</span>
<span class="n">csv_file</span> <span class="o">=</span> <span class="s2">&quot;reply_author_count.csv&quot;</span>
<span class="n">csv_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Prevent warning messages</span>
<span class="n">df_user</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">csv_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_user</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="n">df_user</span><span class="p">[[</span><span class="s1">&#39;Reply Author&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">df_user</span><span class="p">[[</span><span class="s1">&#39;Reply Author&#39;</span><span class="p">]])</span>

<span class="c1"># Rename columns: &#39;Reply Date&#39; to &#39;Date&#39;, &#39;Reply Author&#39; to &#39;ln_user&#39;</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Reply Date&#39;</span><span class="p">:</span> <span class="s1">&#39;Date&#39;</span><span class="p">})</span>
<span class="n">df_user</span> <span class="o">=</span> <span class="n">df_user</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Reply Date&#39;</span><span class="p">:</span> <span class="s1">&#39;Date&#39;</span><span class="p">})</span>
<span class="n">df_user</span> <span class="o">=</span> <span class="n">df_user</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Reply Author&#39;</span><span class="p">:</span> <span class="s1">&#39;ln_user&#39;</span><span class="p">})</span>

<span class="c1"># Merge Bitcoin data with sentiment divergence data</span>
<span class="n">df_user</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_user</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">)</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">df_by</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">df1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">df3</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">df_user</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>

<span class="c1"># Check and remove missing values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>

<span class="c1"># Rename DataFrame and view data summary</span>
<span class="n">df_merge</span> <span class="o">=</span> <span class="n">df3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_merge</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</code></pre></div>

<h3>5. Finalizing the Regression Dataset</h3>
<ul>
<li>Dropped unnecessary columns (<code>Price</code>, <code>Open</code>, <code>High</code>, <code>Low</code>, <code>sent_t</code>, <code>Vol.</code>, <code>Return_mean</code>, <code>Return_std</code>) that were either intermediate steps or irrelevant to regression. For example, <code>Vol.</code> was replaced by <code>aVol</code>, and raw prices were summarized by <code>Return</code> and <code>Prange</code>.</li>
<li>Renamed <code>disagt_t</code> to <code>Disagt</code> for clarity and consistency.</li>
<li>Saved the final dataset—containing <code>Date</code>, <code>Return</code>, <code>Prange</code>, <code>aVol</code>, <code>Ext_pos</code>, <code>Ext_neg</code>, <code>Disagt</code>, and <code>ln_user</code>—as both a Parquet file (<code>Regression variables.parquet</code>) and an Excel file (<code>Regression variables.xlsx</code>) for further analysis. Deciding which columns to drop was a reflective process—we had to weigh their relevance, and we plan to revisit this if the regression reveals unexpected patterns.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="sd">&#39;&#39;&#39;1.4 Preparing for Regression&#39;&#39;&#39;</span>
<span class="c1"># Drop variables &#39;Price&#39;, &#39;Open&#39;, &#39;High&#39;, &#39;Low&#39;, &#39;sent_t&#39;, &#39;Vol.&#39;, &#39;Return_mean&#39;, &#39;Return_std&#39;</span>
<span class="n">df_merge</span> <span class="o">=</span> <span class="n">df_merge</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span> <span class="s1">&#39;Open&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;sent_t&#39;</span><span class="p">,</span> <span class="s1">&#39;Vol.&#39;</span><span class="p">,</span> <span class="s1">&#39;Return_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;Return_std&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Rename &#39;disagt_t&#39; to &#39;Disagt&#39; and view data summary</span>
<span class="n">df_merge</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;disagt_t&#39;</span><span class="p">:</span> <span class="s1">&#39;Disagt&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_merge</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>

<span class="c1"># Save to current directory</span>
<span class="n">df_merge</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s1">&#39;Regression variables.parquet&#39;</span><span class="p">)</span>
<span class="n">df_merge</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;Regression variables.xlsx&#39;</span><span class="p">)</span>
</code></pre></div>

<h2>Rationale Behind Our Variable Choices</h2>
<ul>
<li><strong>Multiple Volatility Measures</strong>: Using both <code>Return</code> and <code>Prange</code> captures distinct volatility aspects—day-to-day changes versus intraday swings—offering a fuller picture of market dynamics. We chose these after realizing a single measure might miss key patterns.</li>
<li><strong>Normalized Volume</strong>: <code>aVol</code> adjusts for historical trends, isolating relative volume changes potentially driven by sentiment, as raw volumes can reflect market growth over time. This adjustment was a breakthrough after struggling with scale differences.</li>
<li><strong>Extreme Returns as Indicators</strong>: <code>Ext_pos</code> and <code>Ext_neg</code> pinpoint outlier events often linked to sentiment shifts, aiding analysis of whether sentiment divergence amplifies extreme price movements. We found the statistical threshold fascinating and plan to explore alternative thresholds later.</li>
<li><strong>Log-Transformed User Count</strong>: The <code>ln_user</code> transformation addresses skewness in social media activity, ensuring linearity in the regression model. This was a conceptual challenge we overcame by studying data transformation techniques.</li>
<li><strong>Data Cleaning and Merging</strong>: Dropping missing values and irrelevant columns reduces noise and multicollinearity, creating a focused dataset. Reflecting on this, we learned the importance of data quality and intend to refine our cleaning process further.</li>
</ul>


             
 
            
            
            







            <hr/>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2025-03-09T00:00:00+08:00">Sun 09 March 2025</time>
            <h4>Category</h4>
            <a class="category-link" href="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/categories.html#progress-report-ref">Progress Report</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/tags.html#group-fin-tanstic-wizards-ref">Group FIN-TANSTIC WIZARDS
                    <span class="superscript">6</span>
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
    <a href="https://github.com/buehlmaier/MFIN7036-student-blog-2025-01" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="https://buehlmaier.github.io/MFIN7036-student-blog-2025-01/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>